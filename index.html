<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Title tester (124px / max 2 lines)</title>
    <link rel="stylesheet" href="css/style.css" />
</head>
<body>

<h1>Title tester (124px / max 2 lines)</h1>

<p>
    Type your translation directly in the preview tile below. It uses
    <strong>Roboto 15px / line-height 20px</strong> and fixed width
    <strong>124 px</strong>. If the text overflows to a 3rd line, please shorten it.
</p>

<div id="preview" class="preview" contenteditable="true"></div>

<div id="status" class="status">Waiting…</div>
<div id="metrics" class="metrics">
    Characters: 0 · Estimated lines: 1 · Longest word: 0
</div>

<h2>Guidelines</h2>
<ul>
    <li>Maximum <strong>2 lines</strong> inside 124 px width.</li>
    <li>Prefer <strong>up to 3 short words</strong>.</li>
    <li>Avoid very long compound words (more than ~14 characters).</li>
    <li>If it doesn't fit: use a <strong>shorter alternative</strong>.</li>
</ul>

<script>
const preview = document.getElementById('preview');
const status  = document.getElementById('status');
const metrics = document.getElementById('metrics');

function update() {
    const rawText = preview.innerText.replace(/\n+$/g, '').trim();

    requestAnimationFrame(() => {
        const style        = getComputedStyle(preview);
        const lineHeight   = parseFloat(style.lineHeight)    || 20;
        const paddingTop   = parseFloat(style.paddingTop)    || 0;
        const paddingBottom= parseFloat(style.paddingBottom) || 0;

        // высота только текста, без паддингов
        const contentHeight = preview.scrollHeight - paddingTop - paddingBottom;
        const lines = Math.max(1, Math.round(contentHeight / lineHeight));

        const words = rawText.split(/\s+/).filter(Boolean);
        const longestWord = words.reduce((m, w) => Math.max(m, w.length), 0);

        let cls = 'status';
        let msg = '';

        if (!rawText) {
            msg = 'Waiting…';
        } else if (lines > 2) {
            cls += ' error';
            msg = `✘ Too long (${lines} lines) — please shorten`;
        } else if (longestWord > 14) {
            cls += ' warn';
            msg = '✔ Fits in 2 lines, but contains a very long word — shorten if possible.';
        } else {
            cls += ' ok';
            msg = '✔ Fits in 2 lines';
        }

        status.className = cls;
        status.textContent = msg;

        metrics.textContent =
            `Characters: ${rawText.length} · Estimated lines: ${lines} · Longest word: ${longestWord}`;
    });
}

preview.addEventListener('input', update);
preview.addEventListener('keyup', update);

update();
</script>

</body>
</html>
